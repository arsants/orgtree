# OrgTree

OrgTree - это библиотека для работы с древовидными структурами данных в Go. Она предоставляет удобный API для создания, манипуляции и сериализации деревьев.

## Возможности

- Создание и управление древовидными структурами
- Сериализация деревьев в JSON и обратно
- Фильтрация узлов по различным критериям
- Поиск узлов в дереве
- Получение поддеревьев
- Визуализация дерева в консоли
- Полное тестовое покрытие всех функций

## Особенности

- Создание и манипуляция древовидными структурами
- Сериализация в JSON и десериализация из JSON
- Вычисление хеша структуры для отслеживания изменений
- Фильтрация поддеревьев по условию или регулярному выражению
- Обход дерева в ширину (BFS) и глубину (DFS)
- Простой и понятный API

## Требования

- Go 1.16 или выше
- Поддерживаемые операционные системы:
  - Linux
  - macOS
  - Windows

## Установка

```bash
go get github.com/yourusername/orgtree
```

## Использование

### Создание дерева

```go
package main

import "github.com/yourusername/orgtree"

func main() {
    // Создание корневого узла
    root := orgtree.NewNode("root")
    
    // Добавление дочерних узлов
    child1 := orgtree.NewNode("child1")
    child2 := orgtree.NewNode("child2")
    root.AddChild(child1)
    root.AddChild(child2)
    
    // Добавление узлов в поддерево
    grandchild := orgtree.NewNode("grandchild")
    child1.AddChild(grandchild)
}
```

### Получение пути и глубины

```go
// Получение пути к узлу
path := node.GetPath(root)
for _, n := range path {
    fmt.Println(n.Value)
}

// Получение глубины узла
depth, ok := node.GetDepth(root)
if ok {
    fmt.Printf("Глубина узла: %d\n", depth)
}
```

### Работа с должностями

```go
// Создание должностей
position := orgtree.Position{
    ID:      uuid.New(),
    Name:    "Senior Developer",
    Sysname: "senior_developer",
}

// Создание связи между должностью и узлом
relation := orgtree.PositionNodeRelation{
    ID:         uuid.New(),
    NodeID:     cto.ID,
    PositionID: position.ID,
}
```

### Получение связанных узлов

```go
// Получение всех узлов, связанных с текущим
connectedNodes := ceo.GetConnectedNodes()

// Получение всех должностей для узла
positions := cto.GetPositions()
```

### Сериализация в JSON

```go
// Сериализация дерева в JSON
jsonData, err := orgtree.ToJSON(root)
if err != nil {
    log.Fatal(err)
}

// Десериализация JSON обратно в дерево
tree, err := orgtree.FromJSON(jsonData)
if err != nil {
    log.Fatal(err)
}
```

### Вычисление хеша

```go
// Получение хеша в виде байтов
hash := root.Hash()

// Получение хеша в виде строки
hashString := root.HashString()
```

### Фильтрация и поиск

```go
// Поиск узла по значению
node := root.Find("child1")

// Фильтрация узлов по предикату
filtered := root.Filter(func(value interface{}) bool {
    if str, ok := value.(string); ok {
        return len(str) > 5
    }
    return false
})

// Получение поддерева
subtree := root.SubTree("child1")
```

### Визуализация

```go
// Вывод дерева в консоль
root.PrintTree()
```

## Тестирование

Библиотека имеет полное тестовое покрытие. Все основные функции протестированы:

- `Node` - базовые операции с узлами
- `TreeBuilder` - построение деревьев
- `JSON` - сериализация и десериализация
- `Filter` - фильтрация узлов
- `NodeUtils` - утилиты для работы с деревом

Запуск тестов:

```bash
go test ./...
```

## Структура проекта

```
orgtree/
├── cmd/                  # Директория с исполняемыми файлами
│   └── orgtree/         # Основной исполняемый файл
│       └── main.go      # Точка входа приложения
├── binaries/            # Директория для скомпилированных бинарных файлов
├── node.go              # Основные структуры и интерфейсы
├── node_utils.go        # Вспомогательные функции для работы с узлами
├── iterator.go          # Реализация итераторов для обхода дерева
├── filter.go            # Функции фильтрации дерева
├── node_test.go         # Тесты базовых операций с узлами
├── filter_test.go       # Тесты фильтрации
├── hash_test.go         # Тесты хеширования
├── json_test.go         # Тесты сериализации
├── orgtree.json         # Пример JSON-структуры
├── go.mod               # Go модуль
├── Makefile             # Команды для сборки и тестирования
├── .gitignore          # Игнорируемые Git файлы
└── README.md            # Документация
```

## Сборка и тестирование

Проект использует Makefile для автоматизации задач:

```bash
make help      # Показать список доступных команд
make build     # Собрать проект
make run       # Собрать и запустить приложение
make test      # Запустить тесты
make test-all  # Запустить все тесты с генерацией отчета о покрытии
make clean     # Очистить скомпилированные файлы
make fmt       # Отформатировать код
make vet       # Проверить код на потенциальные ошибки
make lint      # Запустить линтер
make all       # Выполнить полный цикл: форматирование, проверку, тесты и сборку
```

Все скомпилированные файлы сохраняются в директории `binaries/`.

## Ограничения

- Максимальная глубина дерева ограничена только доступной памятью
- Сериализация поддерживает только JSON формат
- Значения узлов должны быть сериализуемыми в JSON

## Планы развития

- [ ] Добавление поддержки XML сериализации
- [ ] Реализация параллельного обхода дерева
- [ ] Добавление поддержки версионирования структуры
- [ ] Интеграция с базами данных
- [ ] Добавление веб-интерфейса для визуализации

## Лицензия

MIT 